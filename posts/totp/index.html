<!doctype html><html lang=en-us><head><title>TOTP | PinYi - Software Engineer</title><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="是一種根據預共享的金鑰與當前時間計算一次性密碼的演算法"><meta name=generator content="Hugo 0.81.0"><meta name=ROBOTS content="NOINDEX, NOFOLLOW"><link rel=stylesheet href=/hugo.blog/css/style.css><link rel="shortcut icon" href=/hugo.blog/images/favicon.ico type=image/x-icon></head><body><nav class=navigation><a href=/hugo.blog/><span class=arrow>←</span>Home</a>
<a href=/hugo.blog/posts>Archive</a>
<a href=/hugo.blog/tags>Tags</a>
<a href=/hugo.blog/about>About</a></nav><main class=main><section id=single><h1 class=title>TOTP</h1><div class=tip><time datetime="2022-08-01 22:00:00 +0800 +0800">Aug 1, 2022</time>
<span class=split>·</span>
<span>80 words</span>
<span class=split>·</span>
<span>1 minute read</span></div><div class=content><p>是一種根據預共享的金鑰與當前時間計算一次性密碼的演算法</p><blockquote><p>此篇為各筆記之整理，非原創內容，資料來源可見文後參考資料連結。</p></blockquote><hr><h4 id=totp>TOTP <a href=#totp class=anchor>🔗</a></h4><ul><li>是雜湊訊息鑑別碼當中的一個例子。</li><li>結合一個私鑰與當前時間戳，使用一個密碼雜湊函式來生成一次性密碼。</li><li>時間戳通常以30秒為間隔。</li></ul><p><a href=https://zh.wikipedia.org/zh-tw/%E5%9F%BA%E4%BA%8E%E6%97%B6%E9%97%B4%E7%9A%84%E4%B8%80%E6%AC%A1%E6%80%A7%E5%AF%86%E7%A0%81%E7%AE%97%E6%B3%95 target=_blank rel=noopener>參考連結</a></p><hr><h4 id=start-step>Start Step <a href=#start-step class=anchor>🔗</a></h4><ol><li>Server 生成帶有 Secret Key 的 QRCode</li><li>用 Authentication App 掃描 QRCode，App 就會把 Secret Key 存起來</li><li>以後 App 就會用這個 Secret Key 生成 TOTP</li><li>Server 驗證兩邊生成相同的 TOTP，確保 Secret Key 正確</li><li>Server 啟動 TOTP 成功</li></ol><blockquote><p>因為 App 希望每 30 秒產生出不同的 TOTP，所以他會把 timestamp/30 的整數部分跟 Secret Key 這兩個東西丟進去 HMAC 做雜湊，雜湊的結果轉成十進位取最後六碼</p></blockquote><p><a href=https://medium.com/starbugs/totp-2fa-algorithm-in-10-mins-25acc3c35df9 target=_blank rel=noopener>參考連結</a></p><hr><h4 id=security>Security <a href=#security class=anchor>🔗</a></h4><ul><li>因為 TOTP 有六位數，所以有 100 萬種可能性，而且每 30 秒就換一個</li><li>如果你想要在 30 秒內猜出來，那每秒就需要進行超過 3 萬次登入</li><li>除非你的 secret key 一開始就被偷走，不然是足夠安全的</li></ul><p><a href=https://medium.com/starbugs/totp-2fa-algorithm-in-10-mins-25acc3c35df9 target=_blank rel=noopener>參考連結</a></p><hr><h4 id=ibm-totp-api>IBM TOTP API <a href=#ibm-totp-api class=anchor>🔗</a></h4><p><a href="https://www.ibm.com/docs/zh-tw/security-verify?topic=areuc-using-time-based-one-time-password-totp-in-api-client" target=_blank rel=noopener>參考連結</a></p><hr></div><div class=tags><a href=https://pinyi-lee.github.io/hugo.blog/tags/security>security</a></div></section></main><footer id=footer><div class=copyright>© Copyright
2023
<span class=split><svg fill="#bbb" width="15" height="15" id="heart-15" xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 15 15"><path d="M13.91 6.75c-1.17 2.25-4.3 5.31-6.07 6.94-.1903.1718-.4797.1718-.67.0C5.39 12.06 2.26 9 1.09 6.75-1.48 1.8 5-1.5 7.5 3.45 10-1.5 16.48 1.8 13.91 6.75z"/></svg></span></div><div class=powerby>Powered by <a href=http://www.gohugo.io/>Hugo</a> Theme By <a href=https://github.com/nodejh/hugo-theme-mini>nodejh</a></div></footer></body></html>